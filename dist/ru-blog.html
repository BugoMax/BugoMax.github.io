<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>MRozhaev</title><link rel="stylesheet" href="css/fonts.css"><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600&amp;subset=cyrillic" rel="stylesheet"><link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="libs/font-awesome-4.7.0/css/font-awesome.min.css"> <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700|Merriweather:400italic,400' rel='stylesheet' type='text/css'> <link rel="stylesheet" href="css/reset.css"> <link rel="stylesheet" href="css/blog.css"> <script src="js/modernizr.js"></script><!--[if lt IE 9]> <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]--> </head> <body> <header class="main-header"> <div class="main-header__language"> <a class="main-header__language-en" href="blog.html">en <i class="fa fa-language" aria-hidden="true"></i></a> <a class="main-header__language-ru" href="#0">ru <i class="fa fa-language" aria-hidden="true"></i></a> </div><a class="main_header__logo-wrap" href="index.html"> <img class="main-header__logo" width="300" height="150" src="images/logo.svg" alt="logo"> </a> <div class="main-header__me"> <img class="main-header__main-photo" src="images/main.png" width="130" height="130" alt="I"> <h2 class="main-header__name">Рожаев Максим</h2> <h4 class="main-header__proffesion">Front-end developer <br>(Украина, Киев)</h4> </div><div class="main-header__links"> <h3 class="main-header__h-link"><a class="main-header__home-link" href="ru-index.html">Главная</a></h3> <ul class="main-header__list"> <h3 class="main-header__h-link"><a class="main-header__about" href="ru-about.html">О мне</a></h3> <li class="main-header__li-link"><a class="main-header__about-link" href="ru-skills.html">Навыки</a></li><li class="main-header__li-link"><a class="main-header__about-link" href="ru-storytell.html">Рассказ о мне</a></li><li class="main-header__li-link"><a class="main-header__about-link" href="ru-expiriense.html">Опыт и образование</a></li><li class="main-header__li-link"><a class="main-header__about-link main-header__link-active link-active__about" href="#0">Блог</a></li></ul> <ul class="main-header__list main-header__list-2"> <h3 class="main-header__h-link"><a class="main-header__works" href="ru-works.html">Работы</a></h3> <li class="main-header__li-link"><a class="main-header__works-link" href="ru-works.html">Все</a></li><li class="main-header__li-link"><a class="main-header__works-link" href="ru-works.html">Лучшие</a></li><li class="main-header__li-link"><a class="main-header__works-link" href="ru-works.html">Последние</a></li></ul> <ul class="main-header__list main-header__list-3"> <h3 class="main-header__h-link"><a class="main-header__contact" href="ru-contact.html">Свяжитесь со мной</a></h3> <div class="main_header__social"> <ul> <li class="main_header__social-li"><a href="https://www.linkedin.com/in/maxim-rozhaev-1392b0117" class="main_header__social-links" target="_blank"><i class="fa fa-linkedin-square fa-2x" aria-hidden="true"></i></a></li><li class="main_header__social-li"><a href="https://github.com/BugoMax" class="main_header__social-links" target="_blank"><i class="fa fa-github fa-2x" aria-hidden="true"></i></a></li><li class="main_header__social-li"><a href="https://www.facebook.com/maxim.vasilevich.9" class="main_header__social-links" target="_blank"><i class="fa fa-facebook-square fa-2x" aria-hidden="true"></i></a></li><li class="main_header__social-li"><a href="https://vk.com/bugook" class="main_header__social-links" target="_blank"><i class="fa fa-vk fa-2x" aria-hidden="true"></i></a></li></ul> </div><li class="main-header__li-link"><a class="main-header__contact-link" href="#0">Тел: +38 093 1102 404</a></li></ul> </div></ul></div></header><div class="projects-container"> <ul> <li class="cd-single-project"> <div class="cd-title"> <h2>Использования MVC на простом примере</h2> <p>Часть 1</p></div><div class="cd-project-info"> <div class="project-text-container"> <p> Эта статья рассчитана для тех, кто уже имеет базовые знания о MVC и ООП. Если Вы еще не знакомы с ними, то предлагаю ознакомится с парочкой замечательных статей, которые дадут Вам нужные знания для того, чтобы понимать, что тут происходит: </p><a class="special-link" href="https://tproger.ru/articles/mvc/">От tproger (MVC)</a> <a class="special-link" href="http://ruseller.com/lessons.php?id=666">От ruseller (MVC)</a> <a class="special-link" href="http://ruseller.com/lessons.php?id=1145">От ruseller (ООП)</a> <a class="special-link" href="https://www.youtube.com/playlist?list=PL5QUj3iB7EoJGDMxuzlV58uh0ybgAHlcN">Ряд видео о ООП</a> <p> В этом примере мы буду настраивать вывод новостей на тестовом сайте. А в этой статье будет идти работа над админ частью, где будут создаваться новости. В следующей части будем делать вывод новостей на клиенте, которые мы будем создавать в админке. При написание этого кода использовался фреймворк - <a href="http://codeigniter3.info/">CodeIgniter</a>. </p><p> Наша задача дать возможность админу создавать новость с названием, описанием, изображением, самим содержимым, SEO ссылкой, датой и временем. </p><p> Начнем с того, что нужно создать таблицу в базе данных с соответствующими колонками для сохранения информации. Вот что у нас вышло: </p><table class="project-table"> <thead> <tr> <th>Имя</th> <th>Тип</th> <th>Сравнение</th> <th>Дополнительно</th> </tr></thead> <tbody> <tr> <td>id</td><td>int</td><td>-</td><td>AUTO_INCREMENT</td></tr><tr> <td>title</td><td>varchar(255)</td><td>utf8_general_ci</td><td>-</td></tr><tr> <td>description</td><td>text</td><td>utf8_general_ci</td><td>-</td></tr><tr> <td>img</td><td>varchar(255)</td><td>latin1_swedish_ci</td><td>-</td></tr><tr> <td>content</td><td>text</td><td>utf8_general_ci</td><td>-</td></tr><tr> <td>seo_url</td><td>varchar(65)</td><td>latin1_swedish_ci</td><td>-</td></tr><tr> <td>content</td><td>text</td><td>utf8_general_ci</td><td>-</td></tr><tr> <td>status</td><td>tinyint(1)</td><td>-</td><td>-</td></tr><tr> <td>date</td><td>date</td><td>-</td><td>-</td></tr><tr> <td>time</td><td>time</td><td>-</td><td>-</td></tr></tbody> </table> <p> id с "AUTO_INCREMENT" для того, чтобы автоматически увеличивать на одну единицу каждую новую новость. Для "status" выбран такой тип для того, чтобы записывать 0 или 1, где 0 - это false при котором новость не будет отображаться, а 1 - это true при которой новость будет отображаться. </p><p> "date" и "time" очевидно. А все остальные для обычной строки. </p><p> После этого создаем <strong>модель</strong>, через которую будем обращаться к базе данных, чтобы записать информацию, обновить или взять ее. Все операции с базой данных проходят здесь. </p> <p> Вы можете навести на синий кружок возле функции, чтобы детально в ней разобратся или прочесть здесь. </p><p class="note">Также код ниже можно розвернуть, если интересно.</p> <p class="show-code">model/shop.php</p><pre class="hidden-code">
            <code>
              < ?php {

                <span class="code-blue">class</span> News <span class="code-blue">extends</span> CI_Model
                {
                  
                  <span class="code-blue">private</span> $table = '<span class="code-green">news</span>';

                  <span class="code-blue">public function</span> __<span class="code-red">construct()</span>
                  {
                      <span class="code-blue">parent</span>::__<span class="code-red">construct()</span>;
                  }
                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Эта функция берет всю информацию с заданной базы данных и возвращает содержимое. </p>
                    </div>
                  </div>
                  <span class="code-blue">function</span> <span class="code-red">get_all()</span>
                  {
                      <span class="code-blue">return</span> $this->db-><span class="code-red">get</span>($this->table)-><span class="code-red">result</span>();
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Берет заданый id с базы данных. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">get_by_id</span>($id)
                  {
                      <span class="code-blue">return</span> $this->db-><span class="code-red">where</span>('<span class="code-green">id</span>', $id)-><span class="code-red">get</span>($this->table)-><span class="code-red">row</span>();
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Эта функция записывает или добавляет всю информацию в базу данных. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">add</span>($data)
                  {
                      $this->db-><span class="code-red">insert</span>($this->table, $data);
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Перезаписывает информацию в базе данных. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">update</span>($id, $data)
                  {
                      $this->db-><span class="code-red">where</span>('<span class="code-green">id</span>', $id)-><span class="code-red">set</span>($data)-><span class="code-red">update</span>($this->table);
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Берет заданый id с базы данных. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">getNewsItem</span>($id)
                  {
                      <span class="code-blue">return</span> $this->db-><span class="code-red">where</span>('<span class="code-green">id</span>', $id)-><span class="code-red">get</span>($this->table)-><span class="code-red">row</span>();
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Перезаписывает информацию в базе данных. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">updateNewsItem</span>($id, $data)
                  {
                      $this->db-><span class="code-red">where</span>('id', $id)-><span class="code-red">set</span>($data)-><span class="code-red">update</span>($this->table);
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Удаляет колонку с заданым id для того, что бы удалить новость. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">delete_one_by_id</span>($id)
                  {
                      $this->db-><span class="code-red">where</span>('<span class="code-green">id</span>', $id)-><span class="code-red">delete</span>($this->table);
                  }

              }
            </code>
          </pre> <div class="block-description"> <h3>get_all() - </h3> <p> эта функция берет всю информацию с заданной базы данных и возвращает содержимое. </p></div><div class="block-description"> <h3>get_by_id() - </h3> <p> принимает id, который приходит аргументом, в базе и возвращает колонку с этим id. </p></div><div class="block-description"> <h3>add() - </h3> <p> эта же функция записывает всю полученную информацию в базу данных. </p></div><div class="block-description"> <h3>update() - </h3> <p> перезаписывает информацию, в заданной новости (аргумент $id), заданной информацией (второй аргумент) в базе. </p></div><div class="block-description"> <h3>delete_one_by_id() - </h3> <p> удаляет колонку с заданым id для того, что бы удалить новость. </p></div><div class="block-description"> <h3>getNewsItem() и updateNewsItem() - </h3> <p> тоже самое что и get_by_id() и update(). </p></div><p> Мы только что задали функции с помощью которых сможем манипулировать информацией с базы данных. </p><p> Теперь переходим к <strong>контроллеру</strong> - место, где хранится вся логика. Так как нам приходится работать с обработкой форм, а их там немало, то кода может показаться много. Это не так. 40% кода занимает работа с формами. Эти скучные участки можно пропускать. </p><p class="show-code">controller/shop.php</p><pre class="hidden-code">
            <code>
            < ?php {

              <span class="code-blue">class</span> News_controller <span class="code-blue">extends</span> MY_Admin
              {

                  <span class="code-blue">function</span> __<span class="code-red">construct</span>()
                  {
                      <span class="code-blue">parent</span>:: __<span class="code-red">construct</span>();

                      $this->load-><span class="code-red">model</span>( '<span class="code-green">news</span>' );

                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Отвечает за вывод всей информации, отображения. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">index</span>()
                  {

                      $config['<span class="code-green">base_url</span>'] = <span class="code-red">site_url</span>( '<span class="code-green">news/index/page</span>' );
                      $data['<span class="code-green">page</span>'] = '<span class="code-green">news/index</span>';

                      $news = $this->news-><span class="code-red">get_all</span>();
                      $data['<span class="code-green">news</span>'] = $news;

                      $data['<span class="code-green">page_head_title</span>'] = <span class="code-red">lang</span>( 'News' );

                      $this->load->view('<span class="code-green">template</span>', $data);

                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Берет информацию с форм и отправляет их в модель, которая в свою очередь - в базу данных. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">add</span>()
                  {

                      $this->load-><span class="code-red">library</span>( '<span class="code-green">form_validation</span>' );
                      $this->form_validation-><span class="code-red">set_rules</span>( '<span class="code-green">title</span>', 'Название', 'trim|required' );
                      $this->form_validation-><span class="code-red">set_rules</span>( '<span class="code-green">description</span>', 'Описание', 'trim|required' );
                      $this->form_validation-><span class="code-red">set_rules</span>( '<span class="code-green">image</span>', 'Изображение', 'trim|required' );
                      $this->form_validation-><span class="code-red">set_rules</span>( '<span class="code-green">content</span>', 'Содержимое', 'trim|required' );
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">seo_url</span>', 'SEO ссылка', 'trim|required|min_length[2]|max_length[100]|is_unique[news.seo_url]');
                      $this->form_validation-><span class="code-red">set_rules</span>( '<span class="code-green">date</span>', 'Дата', 'trim|required' );
                      $this->form_validation-><span class="code-red">set_rules</span>( '<span class="code-green">time</span>', 'Время', 'trim|required' );

                      $this->form_validation-><span class="code-red">set_message</span>('required', 'Поле %s не должно быть пустым');
                      $this->form_validation-><span class="code-red">set_message</span>('is_unique', 'Поле %s должно быть уникальным');
                      $this->form_validation-><span class="code-red">set_message</span>('min_length', 'Поле %s должно быть больше %s символов');
                      $this->form_validation-><span class="code-red">set_message</span>('max_length', 'Поле %s должно быть меньше %s символов');

                      <span class="code-blue">if</span> ($this->form_validation-><span class="code-red">run</span>() === FALSE) {

                          $data['<span class="code-green">page</span>'] = 'news/add';
                          $data['<span class="code-green">page_head_title</span>'] = <span class="code-red">lang</span>( '<span class="code-green">News</span>' );

                          $this->load->view('<span class="code-green">template</span>', $data);

                      } <span class="code-blue">else</span> {

                          $news_item = <span class="code-blue">array</span>();
                          $news_item['<span class="code-green">title</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">title</span>');
                          $news_item['<span class="code-green">description</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">description</span>');
                          $news_item['<span class="code-green">img</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">image</span>');
                          $news_item['<span class="code-green">content</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">content</span>');
                          $news_item['<span class="code-green">seo_url</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">seo_url</span>');
                          $news_item['<span class="code-green">status</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">status</span>');
                          $news_item['<span class="code-green">date</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">date</span>');
                          $news_item['<span class="code-green">time</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">time</span>');

                          $this->news-><span class="code-red">add</span>($news_item);

                          $this->session->set_flashdata('msg', <span class="code-blue">array</span>('type' => 'success', 'message' => <span class="code-red">lang</span>('News added!')));
                          redirect('news');

                      }
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Эта функция делает то же, что и предыдущая, только берется уже созданая новость и обновляет данные. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">update</span>($id = FALSE)
                  {

                      $news_item = $this->news-><span class="code-red">get_by_id</span>($id);

                      $this->load-><span class="code-red">library</span>('<span class="code-green">form_validation</span>');

                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">title</span>', 'Название', 'trim|required');
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">description</span>', 'Описание', 'trim|required');
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">content</span>', 'Содержимое', 'trim|required');
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">seo_url</span>', 'SEO ссылка', 'trim|required|min_length[2]|max_length[100]|is_unique[news.seo_url]');
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">date</span>', 'Дата', 'trim|required');
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">time</span>', 'Время', 'trim|required');
                      $this->form_validation-><span class="code-red">set_rules</span>('<span class="code-green">image</span>', 'Изображение', 'trim|required');

                      $this->form_validation-><span class="code-red">set_message</span>('required', 'Поле %s не должно быть пустым');
                      $this->form_validation-><span class="code-red">set_message</span>('is_unique', 'Поле %s должно быть уникальным');
                      $this->form_validation-><span class="code-red">set_message</span>('min_length', 'Поле %s должно быть больше %s символов');
                      $this->form_validation-><span class="code-red">set_message</span>('max_length', 'Поле %s должно быть меньше %s символов');

                      <span class="code-blue">if</span> ($this->form_validation-><span class="code-red">run</span>() === FALSE) {
                          $data['<span class="code-green">page</span>'] = 'news/update';

                          $data['<span class="code-green">page_head_title</span>'] = <span class="code-red">lang</span>('News update');
                          $data['<span class="code-green">news_item</span>'] = $news_item;
                          $rows['<span class="code-green">image</span>'] = $news_item->img;

                          $this->load->view('<span class="code-green">template</span>', $data);

                      } <span class="code-blue">else</span> {

                          $rows['<span class="code-green">title</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">title</span>');
                          $rows['<span class="code-green">description</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">description</span>');
                          $rows['<span class="code-green">img</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">image</span>');
                          $rows['<span class="code-green">content</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">content</span>');
                          $rows['<span class="code-green">seo_url</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">seo_url</span>');
                          $rows['<span class="code-green">status</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">status</span>');
                          $rows['<span class="code-green">date</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">date</span>');
                          $rows['<span class="code-green">time</span>'] = $this->input-><span class="code-red">post</span>('<span class="code-green">time</span>');

                          $this->news-><span class="code-red">update</span>($id, $rows);

                          $this->session->set_flashdata('msg', <span class="code-blue">array</span>('type' => 'success', 'message' => 'Новость '.$news_item->title.' обновлена'));
                          redirect('news');

                      }
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Эта же функция обновляет статус. То есть, будет ли новость активна или нет. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">news_item_update_status</span> ($id = false) {
                      $news_item = $this->news-><span class="code-red">getNewsItem</span>($id);
                      $this->news-><span class="code-red">updateNewsItem</span>($id,['<span class="code-green">status</span>' => $news_item->status == 1 ? '0' : '1']);
                      $this->session->set_flashdata('msg', <span class="code-blue">array</span>('<span class="code-green">type</span>' => 'success', 'message' => 'Статус успешно обновлен'));
                      redirect('news');
                  }

                  <div class="hint">
                    <span class="hint-circle">
                      <span class="circle-pulsate"></span>
                    </span>
                    <div class="hint-text">
                      <p>Здесь новость берется по id и удаляется. </p>
                    </div>
                  </div>

                  <span class="code-blue">function</span> <span class="code-red">delete</span>($id = FALSE)
                  {
                      $this->news-><span class="code-red">delete_one_by_id</span>($id);
                      redirect('news');
                  }
              }
            </code>
          </pre> <div class="block-description"> <h3>function index() - </h3> <p> отвечает за вывод всей информации, запускает страницу. </p></div><div class="block-description"> <h3>function add() - </h3> <p> эта функция, как вы уже догадались, отвечает за добавление новых статей. Здесь мы сначала задаем параметры валидации форм через <strong>set_rules</strong> и также задаем сообщения, которые будут выводится при ошибке соответствующего поля с помощью <strong>set_message</strong>. В первом условии, если валидация дала ошибку, то мы обновляем страницу и показываем ошибку, а во втором условии - мы записываем в массив всю введенную информацию из форм и с помощью функции модели add() добавляем все в базу данных. И выводим сообщение что все прошло успешно. </p></div><div class="block-description"> <h3>function update() - </h3> <p> эта функция делает то же, что и предыдущая, правда сначала берется конкретная новость по id и с ней уже идет работа. </p></div><div class="block-description"> <h3>function news_item_update_status() - </h3> <p> эта же функция обновляет статус. То есть, будет ли новость активна или нет. </p></div><div class="block-description"> <h3>function delete() - </h3> <p> здесь соответственно удаляется новость. </p></div><p> Мы создали модель и контроллер с помощью которых теперь можно вывести все с чем мы работали и будем работать. В целом, все самое сложное и интересное позади, осталось только все вывести. </p><p> Конечный результат выглядит так: </p><img class="full-image" src="images/blog_news.png"> <p> Переходим к виду, где собственно будем отображать всю полученную информацию с контроллера. Следующий файл отвечает за отображения всех новостей в админке. </p><p> Он выглядит так: </p><p class="note"> Код ниже можно розвернуть, если интересно. </p><p class="show-code">view/index.php</p>
          <pre class="hidden-code">
            <code>
              < div class="container">
                < div class="contentbox">
                    < a href="<?php echo site_url('news/add' ) ?>">Добавить</a>
                    < table style="width: 100%; border: 0;">

                        < thead>
                            < tr>
                                < th>id< /th>
                                < th width="1%">Изображение< /th>
                                < th>Название< /th>
                                < th>SEO url< /th>
                                < th>Статус публикации< /th>
                                < th>Дата публикации< /th>
                                < th>Время публикации< /th>
                                < th>< /th>
                            < /tr>
                        < /thead>

                        < tbody>

                            < ?php foreach ($news as $news_item) : ?>
                                < tr>
                                    < td>< ?php echo $news_item->id ?>< /td>
                                    < td>
                                        < a href="< ?php echo site_url('news') ?>/update/< ?php echo $news_item->id ?>">< img src="/uploads/news/small/< ?php echo $news_item->img ?>" alt="">< /a>
                                    < /td>
                                    < td>< a href="< ?php echo site_url('news') ?>/update/< ?php echo $news_item->id ?>">< ?php echo $news_item->title ?>< /a>< /td>
                                    < td>< ?php echo $news_item->seo_url ?>< /td>
                                    < td>
                                        < a href="< ?php echo site_url('news')?>/news_item_update_status/< ?=$news_item->id?>">
                                            < ?=$news_item->status == 1 ? '< span style="color:green;">Включен< /span>': '< span style="color: brown">Отключен< /span>'?>
                                        < /a>
                                    < /td>
                                    < td>< ?php echo $news_item->date ?>< /td>
                                    < td>< ?php echo $news_item->time ?>< /td>
                                    < td>
                                        < a href="< ?php echo site_url( 'news' ) ?>/update/< ?php echo $news_item->id ?>">
                                            < img src="< ?php echo assets_url('admin/images/icons/icon_edit.png') ?>" alt="">
                                        < /a>
                                        < a href="< ?php echo site_url( 'news' )?>/delete/< ?php echo $news_item->id ?>"
                                           onclick="if(confirm('< ?php echo lang( 'Are you sure you want to delete this news?' )?>')) { return: true;} else { return: false; } ">
                                            < img src="< ?php echo assets_url('admin/images/icons/icon_unapprove.png') ?>" alt="">
                                        < /a>
                                    < /td>
                                < /tr>
                            < ?php endforeach;?>

                        < /tbody>

                    < /table>
                < /div>
              < /div>
            </code>
          </pre>
          <p>
            Следующий файл нужен для добавления новостей.
          </p>
          <p class="show-code">
            view/add.php
          </p>
          <pre class="hidden-code">
            <code>
              < div class="container">
                < div class="conthead">
                    < h2>< a href="< ?php echo site_url('news') ?>">&laquo; Назад< /a> < ?= $page_head_title ?>< /h2>
                < /div>
                < div class="contentbox">
                    < ?php echo form_open('news/add') ?>
                    < div class="inputboxes">
                        < label for="title">Название: < /label>
                        < ?php echo form_input('title', set_value('title'), 'class="inputbox"') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="description">Описание: < /label>
                        < ?php echo form_textarea('description', set_value('description'), 'id="description" class="inputbox"') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="image-input">Изображение: < /label>
                        < input type="text" readonly="true" name="image" class="inputbox" id="image-input" value="< ?=set_value('image') ?>">
                        < button class="btn btn-success" type="button" onclick="selectImage('image')">Выбрать< /button>
                        < img src="http://placehold.it/160x120" id="image-image" style="display: block;">
                    < /div>

                    < div class="inputboxes">
                        < label for="wysiwyg">Содержимое: < /label>
                        < ?php echo form_textarea('content', set_value('content'), 'id="wysiwyg" class="inputbox"') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="seo-url">SEO ссылка: < /label>
                        < ?php echo form_input('seo_url', set_value('seo_url'), 'id="seo-url" class="inputbox" oninput="this.value = this.value.replace(/[^-_0-9a-z]/gim,\'\').toLowerCase()" ') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="status">Статус публикации: < /label>
                        < ?php echo form_dropdown('status', ['1' => 'Опубликовано', '0' => 'Не опубликовано'])?>
                    < /div>

                    < div class="inputboxes">
                        < label for="date">Дата: < /label>
                        < input type="date" id="date" class="inputbox" name="date"  value="< ?php echo set_value('date');?>">
                    < /div>

                    < div class="inputboxes">
                        < label for="time">Время: < /label>
                        < input type="time" id="time" class="inputbox" name="time"  value="< ?php echo set_value('time');?>">
                    < /div>

                    < hr>
                    < ?php echo form_submit('submit', 'Сохранить', 'class="btn"') ?>

                    < ?php echo form_close() ?>
                < /div>

            < /div>
            < script>
                function selectImage(input_id) {
                    var folder = 'news';

                    if(!$('#files').length) {
                        $('body').append('< div id="files" style="display: none;">< /div>');
                    }
                    $(document).bind('onSelectImage', function(e) {
                        $('#' + input_id + '-input').attr('value', e.detail.name);
                        $('#' + input_id + '-image').attr('src', '/uploads/' + folder + '/small/' + e.detail.name);
                    });
                    $("#files").load('< ?php echo site_url('imagemanager')?>?folder=' + folder, function() {
                        $('#files').show();
                    });

                }
            < /script>
            </code>
          </pre>
          <p>
            Файл ниже - обновляет новости.
          </p>
          <p class="show-code">
            view/update.php
          </p>
          <pre hidden="hidden-code">
            <code>
              < div class="container">
                < div class="conthead">
                    < h2>< a href="< ?php echo site_url('news')?>">&laquo; Назад< /a> < ?=$page_head_title?>< /h2>
                < /div>
                < div class="contentbox">
                    < ?php echo form_open('news/update/' . $news_item->id) ?>

                    < div class="inputboxes">
                        < label for="title">Название: < /label>
                        < ?php echo form_input('title', set_value('title', $news_item->title), 'class="inputbox"') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="description">Описание: < /label>
                        < ?php echo form_textarea('description', set_value('description', $news_item->description), 'id="description" class="inputbox"') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="image-input">Изображение: < /label>
                        < input type="text" readonly="true" name="image" class="inputbox" id="image-input" value="< ?=set_value('image', $news_item->img) ?>">
                        < button class="btn btn-success" type="button" onclick="selectImage('image')">Выбрать< /button>
                        < img src="< ?php echo main_url('/uploads/news/small/'.$news_item->img)?>" id="image-image" style="display: block;">
                    < /div>

                    < div class="inputboxes">
                        < label for="wysiwyg">Содержимое: < /label>
                        < ?php echo form_textarea('content', set_value('content', $news_item->content), 'id="wysiwyg" class="inputbox"') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="seo-url">SEO ссылка: < /label>
                        < ?php echo form_input('seo_url', set_value('seo_url', $news_item->seo_url), 'id="seo_url" class="inputbox" oninput="this.value = this.value.replace(/[^-_0-9a-z]/gim,\'\').toLowerCase()" ') ?>
                    < /div>

                    < div class="inputboxes">
                        < label for="status">Статус публикации: < /label>
                        < ?php echo form_dropdown('status', ['1' => 'Опубликовано', '0' => 'Не опубликовано'],$news_item->status)?>
                    < /div>

                    < div class="inputboxes">
                        < label for="date">Дата публикации: < /label>
                        < input type="date" id="date" class="inputbox" name="date"  value="< ?php echo set_value('date', $news_item->date);?>">
                    < /div>

                    < div class="inputboxes">
                        < label for="time">Время публикации: < /label>
                        < input type="time" id="time" class="inputbox" name="time"  value="< ?php echo set_value('time', $news_item->time);?>">
                    < /div>


                    < ?php echo form_submit('submit', 'Обновить', 'class="btn"') ?>

                    < ?php echo form_close() ?>
                < /div>

            < /div>
            < script>
                function selectImage(input_id) {
                    var folder = 'news';

                    if(!$('#files').length) {
                        $('body').append('< div id="files" style="display: none;">< /div>');
                    }
                    $(document).bind('onSelectImage', function(e) {
                        $('#' + input_id + '-input').attr('value', e.detail.name);
                        $('#' + input_id + '-image').attr('src', '/uploads/' + folder + '/small/' + e.detail.name);
                    });
                    $("#files").load('< ?php echo site_url('imagemanager')?>?folder=' + folder, function() {
                        $('#files').show();
                    });

                }
            < /script>
            </code>
          </pre> </div></div></li><li class="cd-single-project"> <div class="cd-title"> <h2>В разработке</h2> <p>Я обещаю, что скоро будет сделано.</p></div><div class="cd-project-info"> <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. </p></div></li><li class="cd-single-project"> <div class="cd-title"> <h2>В разработке</h2> <p>Я обещаю, что скоро будет сделано.</p></div><div class="cd-project-info"> <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima, quod dicta aliquid nemo repellendus distinctio minus dolor aperiam suscipit, ea enim accusantium, deleniti qui sequi sint nihil modi amet eligendi, quidem animi error labore voluptatibus sed. Qui magnam labore, iusto nostrum. Praesentium non, impedit accusantium consequatur officia architecto, mollitia placeat aperiam tenetur pariatur voluptatibus corrupti vitae deserunt! Nostrum non mollitia deserunt ipsam. Sunt quaerat natus cupiditate iure ipsa voluptatibus recusandae ratione vitae amet distinctio, voluptas, minus vero expedita ea fugit similique sit cumque ad id facere? Ab quas, odio neque quis ratione. Natus labore sit esse, porro placeat eum hic. </p></div></li></ul> <a href="#0" class="cd-close">Close</a> <a href="#0" class="cd-scroll">Scroll</a></div><script src="js/jquery-2.1.1.js"></script><script src="js/main1.js"></script></body></html>